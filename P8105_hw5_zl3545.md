Homework 5
================
Zeqi Li
2024-11-12

# Problem 1

Define a function that identifies whether at least two people in a group
share the same birthday.

``` r
bday_sim = function(n) {
  bday = sample(1:365, 
                 n, 
                 replace = TRUE)
  return(any(duplicated(bday)))
}
```

Run the simulation for 10000 times for group sizes ranged from 2 to 50
using the above function.

``` r
bday_res = tibble(group_size = rep(2:50, 
                                   each = 10000)) |> 
  mutate(result = map_lgl(group_size, 
                          bday_sim))

res_df = bday_res |> 
  group_by(group_size) |> 
  summarize(avg_prob = mean(result))
```

Plotting probability as a function of group size.

``` r
res_df |> 
  ggplot(aes(x = group_size,
             y = avg_prob)) +
  geom_point() + 
  labs(title = "Average probability of shared birthday in a group",
       x = "Group size",
       y = "Average probability")
```

![](P8105_hw5_zl3545_files/figure-gfm/p1_plot-1.png)<!-- --> COMMENT

# Problem 2

Define a function that models drawing data from a normal distribution
and runs a one-sample t test for each dataset.

``` r
t_test_sim = function(n = 30, 
                      mu, 
                      sigma = 5) {
  data = rnorm(n, 
               mean = mu, 
               sd = sigma)
  
  t_res = t.test(data, 
                 mu = 0,
                 alpha = 0.05)
  
  res_df = t_res |> 
    broom::tidy() |> 
    select(mu_hat = estimate,
           p_value = p.value)
  
  return(res_df)
}
```

Test the above function on $\mu = 0$. Obtain 5000 datasets and t test
results by running the above function.

``` r
mu = 0

mu0_res = expand_grid(id = 1:5000) |> 
  mutate(res = map(id, 
                   ~ t_test_sim(mu = 0))) |> 
  unnest(res)
```

Apply the function on different $\mu$s.

``` r
mu = c(0, 1, 2, 3, 4, 5)
```
